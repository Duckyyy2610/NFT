{% extends 'main.html' %}
{% load my_custom_tags %}
{% block content %}
<div class="container">
    <h1 class="section-heading-fw500">Trade History</h1>
    <ul class="trade-list">
        {% for trade in trades %}
        <li class="trade-item">
            <ul class="trade-repr flex_aic_jcsb">
                <li class="trade-text trade-repr__item">#{{forloop.counter}} NFT</li>
                <li class="trade-text trade-repr__item"><a href="{% url 'collection1' trade.product.id %}" class="trade-text trade-repr__item">{{trade.product.name}}</a></li>
                <li class="trade-text trade-repr__item flex_aic">{{trade.timestamp|facebook_time}}
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 9 7" fill="none"><path d="M8.29688 1.23438L4.5 5.45312L0.703125 1.23438" stroke="white" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                </li>
                
            </ul>
            <ul class="trade-desc">
                <li class="trade-desc__item">
                    <p class="trade-text trade-desc__key">Transaction ID</p>
                    <p class="trade-text trade-desc__value">{{trade.id}}</p>
                </li>
                <li class="trade-desc__item">
                    <p class="trade-text trade-desc__key">Collection</p>
                    <p class="trade-text trade-desc__value"><a href="{% url 'collection1' trade.product.id %}" class="trade-text" style="color: #17E3A6; text-decoration: underline;">{{trade.product.name}}</a></p>
                </li>
                <li class="trade-desc__item">
                    <p class="trade-text trade-desc__key">Time</p>
                    <p class="trade-text trade-desc__value">{{trade.timestamp}}</p>
                </li>
                <li class="trade-desc__item">
                    <p class="trade-text trade-desc__key">Buyer</p>
                    <p class="trade-text trade-desc__value"><a href="{% url 'profile' trade.buyer.id %}" class="trade-text" style="color: #17E3A6; text-decoration: underline;">{{trade.buyer.name}}</a></p>
                </li>
                <li class="trade-desc__item">
                    <p class="trade-text trade-desc__key">Seller</p>
                    <p class="trade-text trade-desc__value"><a href="{% url 'profile' trade.seller.id %}" class="trade-text" style="color: #17E3A6; text-decoration: underline;">{{trade.seller.name}}</a></p>
                </li>
                <li class="trade-desc__item">
                    <p class="trade-text trade-desc__key">Price</p>
                    <p class="trade-text trade-desc__value">{{trade.price_at_purchase}} ETH</p>
                </li>
                <li class="trade-desc__item">
                    <p class="trade-text trade-desc__key">Total items left</p>
                    <p class="trade-text trade-desc__value">{{trade.quantity_at_purchase}}</p>
                </li>
            </ul>
        </li>
        {% endfor %}
    </ul>
</div>
{% endblock content %}

{% block scripts %}
<script>
    const tradeRepr = document.querySelectorAll('.trade-repr');
    // console.log(tradeRepr)
    tradeRepr.forEach((element) => {
        const tradeDesc = element.nextElementSibling;
        element.onclick = (e) => {
            tradeDesc.classList.toggle('show');
            console.log(element.querySelector('svg'));
            element.querySelector('svg').classList.toggle('rotate-180');
        }
        element.querySelector('.trade-repr__item .trade-text').onclick = (e) => {
            e.stopPropagation();
        }
    })
</script>
{% endblock scripts %}